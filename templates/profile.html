{% extends "base.html" %}
{% load static %}

{% block mytitle %}Profile - VoxWave{% endblock %}

{% block mycss %}
<style>
  body {
    -webkit-user-select: none; /* Chrome, Safari, Opera */
    -moz-user-select: none; /* Firefox */
    -ms-user-select: none; /* IE 10+ */
    user-select: none; /* Standard syntax */
    }
    /* Media query for screens smaller than 600px */
    @media (max-width: 767px) {
      /* Custom CSS rules for screens smaller than 600px */
      /* Adjust styles for smaller screens here */
      .profile-image{
        width: 150px;
        height: 150px;
        padding: 6px;
        position: absolute;
        background-color: white;
        top:250px;
        right: 10px;
      }
      
    }

    /* Media query for screens between 601px and 900px */
    @media (min-width: 768px) and (max-width: 899px){
      /* Custom CSS rules for screens between 601px and 900px */
      /* Adjust styles for medium-sized screens here */
      
    }

    /* Media query for screens between 601px and 900px */
    @media (min-width: 900px) and (max-width: 1199px) {
      /* Custom CSS rules for screens between 601px and 900px */
      /* Adjust styles for medium-sized screens here */
      
    }

    /* Media query for screens larger than 901px */
    @media screen and ((min-width: 1200px) and (max-width: 1700px)) {
      /* Custom CSS rules for screens larger than 901px */
      /* Adjust styles for larger screens here */
      
    }
    /* Media query for screens larger than 901px */
    @media screen and (min-width: 1701px) {
      /* Custom CSS rules for screens larger than 901px */
      /* Adjust styles for larger screens here */
      
    }
</style>
{% endblock %}

{% block mybody %}
<div class="w3-container mobile-only" style="position: fixed; top:0px; left:0px; padding: 0px; z-index: 1600;">
<div class="w3-container w3-animate-opacity mobile-only" style="padding-left: 0px; padding-right: 0px; margin-right: 0px; margin-bottom: 0px; position: relative;">
  <div class="w3-container w3-card-4 banner-container" style="padding: 0px; height: 440px; background-color: white; border-bottom-left-radius: 30px; border-bottom-right-radius: 30px;">
    <img src="{% static 'home/images/mobile_banner.jpeg' %}"  style="height: 280px; width: 100%; " class="banner-image w3-border" alt="Banner" />
  </div>
  <img src="{{user_profile.profileimg.url}}"  class="profile-image w3-border w3-circle w3-card-4" alt="Profile Pic" />
  <div class="username w3-text-black capitalize w3-center" style="position: absolute; top: 280px; left: 40px; font-size: 40px;"><b><span>{{user_profile.user.username}}</span></b></div>
  <div class="w3-container" style="position: absolute; height: 100px; width:300px;padding: 0px; top:340px;">
  <div class="w3-container w3-cell w3-center" style="height: 100%;width: 100%;padding-top: 20px;font-size: 16px; ">
    {% if user_followers == 0 or user_followers == 1 %}
		<button type="button" onclick="document.getElementById('follower').style.display='block'" class="w3-btn w3-round-large " style="background-color: transparent; color: black; padding: 0px; margin-left: 0px;"><b>{{user_followers}}<br>Follower</b></button>
	{% else %}
        <button type="button" onclick="document.getElementById('follower').style.display='block'" class="w3-btn w3-round-large " style="background-color: transparent; color: black;  padding: 0px; margin-left: 0px;"><b>{{user_followers}}<br>Followers</b></button>
    {% endif %}
  </div>
  <div class="w3-container w3-cell w3-center" style="height: 100%;width: 100%;padding-top: 20px;font-size: 16px; ">
    {% if user_post_length == 0 %}
	    <b> No<br>Posts</b>
	{% elif user_post_length == 1 %}
		<b>{{user_post_length}}<br>Post</b>
	{% else %}
		<b>{{user_post_length}}<br>Posts</b>
	{% endif %}
    
  </div>
  <div class="w3-container w3-cell w3-center" style="height: 100%;width: 100%;padding-top: 20px;font-size: 16px; ">
    <button type="button" onclick="document.getElementById('following').style.display='block'" class="w3-btn w3-round-large following-count" style="background-color: transparent; color: black; padding: 0px; margin-left: 0px;"><b>{{user_following}}<br>Following</b></button>

  </div>
  


</div>
<a href="/"><button type="button" class="w3-button w3-circle w3-round-large" style="background-color: white; color: grey; position: absolute; top:10px;border-bottom-left-radius: 50px;border-top-left-radius: 50px;border-bottom-right-radius: 50px;border-top-right-radius: 50px; left:20px;z-index: 1000; font-size: 40px;"> <i class="fa fa-home" aria-hidden="true"></i></button></a>
{% if user_object.username == user.username %}
<a href="/settings"><button type="button" class="w3-button w3-circle w3-round-large" style="background-color: white; color: grey; position: absolute; top:150px;border-bottom-left-radius: 50px;border-top-left-radius: 50px;border-bottom-right-radius: 50px;border-top-right-radius: 50px; left:20px;z-index: 1000; font-size: 40px;"> <i class="fa fa-gear fa-spin" ></i></button></a>
{% else%}
<form action="/follow" method="POST">
  {% csrf_token %}
  <input type="hidden" value="{{user.username}}" name="follower" />
  <input type="hidden" value="{{user_object.username}}" name="user" />
  <button type="submit" class="w3-btn w3-border w3-round-large follow-button" style="background-color: white; color: grey; position: absolute; top: 150px; left: 300px;"><b>{{button_text}}</b></button>
</form> 
{% endif %}
</div>
</div>
  <div class="w3-container mobile-only" style="margin-top: 480px; margin-left: 20px; width: 90%;">
    {% for post in user_posts %}
    <div class="w3-card-4 post-card w3-round-xlarge" style="background-color: #f2f2f2; position: relative; margin-bottom: 10px; margin-top: 20px;">
      <img src="{{ post.image.url }}" alt="User-Post" class="w3-round-xlarge" style="width:100%;">
      <div class="w3-container" style="height:auto;margin-bottom: 20px;">
        <h3><b>{{ post.caption }}</b></h3>
      </div>
      {% if user_object.username == user.username %}
      <div class="w3-container" style="position: absolute; top:10px; right:10px;">
        <button type="button" onclick="delete_post('{{user_profile.user.username}}', '{{ post.id }}')" class="delete-button w3-btn"> <b><i class="fa fa-trash" style="font-size: 25px;"></i></b> </button>
      </div>
      {% endif %}
      {% if post.no_of_likes > 0 %}
      <div class="w3-container" style="position: absolute; bottom:85px; right:10px; color: white;">
        <b style="text-shadow:1px 1px 0 #444;">{{post.no_of_likes}}&nbsp;&nbsp;</b><i class="fa fa-thumbs-up" aria-hidden="true" style="font-size: 30px;text-shadow:1px 1px 0 #444;"></i>
      </div>
      {% endif %}
    </div>
    <div class="w3-container">
    </div>
    {% endfor %}
  </div>

<div id="follower" class="w3-modal" style="z-index: 1900;">
  <div class="w3-modal-content w3-card-4 w3-animate-zoom w3-round-xlarge modal-card">
    <header class="w3-container w3-center"> 
      <span onclick="document.getElementById('follower').style.display='none'" 
      class="w3-button w3-display-topright" style="font-size: 25px;">&times;</span>
      <h2><b>FOLLOWER LIST</b></h2>
    </header>
    <div class="w3-container">
      {% for follower in follower_list %}
      
      <div class="w3-hover-shadow" style="margin-bottom: 10px;">
        <div class="w3-container" style="height: 60px; padding: 15px;">
          <div class="w3-container w3-cell w3-center">
        <a href="/profile/{{follower.user}}" style="text-decoration:none;">
         <img class="w3-circle user-img" src="{{follower.profileimg.url}}" alt="Follower Avatar" style="width:30px; height: 30px;" /></a>
        </div>
        <div class="w3-container w3-cell w3-center">
         <a href="/profile/{{follower.user}}" style="text-decoration:none;">
            <span class="modal-names capitalize"><b>{{follower.user}}</b></span>
            </a>
          </div>
          </div>
      </div>
      {% endfor %}
      
    </div>
  </div>
</div>

<div id="following" class="w3-modal" style="z-index: 1900;">
  <div class="w3-modal-content w3-card-4 w3-animate-zoom w3-round-xlarge modal-card">
    <header class="w3-container w3-center"> 
      <span onclick="document.getElementById('following').style.display='none'" 
      class="w3-button w3-display-topright" style="font-size: 25px;">&times;</span>
      <h2><b>FOLLOWING LIST</b></h2>
    </header>
    <div class="w3-container">
      {% for following in following_list %}
      
      <div class=" w3-hover-shadow " style="margin-bottom: 10px;">
        <div class="w3-container" style="height: 60px; padding: 15px;">
        <div class="w3-container w3-cell w3-center">
        <a href="/profile/{{following.user}}" style="text-decoration:none;"> 
        <img class="w3-circle user-img" src="{{following.profileimg.url}}" alt="Follower Avatar" style="width:30px; height: 30px;" /></a>
        </div>
        <div class="w3-container w3-cell w3-center">
        <a href="/profile/{{following.user}}" style="text-decoration:none;"> 
            <span class="modal-names capitalize"><b>{{following.user}}</b></span>
          </a>
        </div>
      </div>
      </div>
      {% endfor %}
      
    </div>
  </div>
</div>

<!--<div class="w3-container w3-animate-opacity desktop-only" style="padding-left: 0px; padding-right: 0px; margin-right: 0px; margin-bottom: 0px; position: relative;">
    <div class="w3-container w3-card-4 banner-container" >
        <img src="{% static 'home/images/profile_banner1.jpg' %}"  class="banner-image w3-border" alt="Banner" />
    </div>  
    <div class="w3-container profile-container w3-card-4" style="position: absolute;">
        <img src="{{user_profile.profileimg.url}}"  class="profile-image w3-border" alt="Profile Pic" />
    </div>  
    {% comment %} {% if user_profile.bio %}
        <div class="bio w3-text-white capitalize" style="position: absolute; z-index: 4;">"{{user_profile.bio}}"</div>
    {% endif %} {% endcomment %}
    <a href="/"><button type="button" class="w3-btn w3-border w3-round-large home-button" style="background-color: transparent; color: white;"> <b>Home</b> </button></a>
    {% if user_post_length == 0 %}
	    <span style="color: white; font-size: 27px; position: absolute;" class="post-count"><b> No Posts</b></span>
	{% elif user_post_length == 1 %}
		<span style="color: white; font-size: 27px; position: absolute;" class="post-count"><b>{{user_post_length}} Post</b></span>
	{% else %}
		<span style="color: white; font-size: 27px; position: absolute;" class="post-count"><b>{{user_post_length}} Posts</b></span>
	{% endif %}

	{% if user_followers == 0 or user_followers == 1 %}
		<button type="button" onclick="document.getElementById('follower').style.display='block'" class="w3-btn w3-border w3-round-large follower-count" style="background-color: transparent; color: white; position: absolute;"><b>{{user_followers}} Follower</b></button>
	{% else %}
        <button type="button" onclick="document.getElementById('follower').style.display='block'" class="w3-btn w3-border w3-round-large follower-count" style="background-color: transparent; color: white; position: absolute;"><b>{{user_followers}} Followers</b></button>
    {% endif %}
		
    <button type="button" onclick="document.getElementById('following').style.display='block'" class="w3-btn w3-border w3-round-large following-count" style="background-color: transparent; color: white; position: absolute;"><b>{{user_following}} Following</b></button>

    <div id="follower" class="w3-modal">
      <div class="w3-modal-content w3-card-4 w3-animate-zoom w3-round-xlarge modal-card">
        <header class="w3-container w3-center"> 
          <span onclick="document.getElementById('follower').style.display='none'" 
          class="w3-button w3-display-topright" style="font-size: 25px;">&times;</span>
          <h2><b>FOLLOWER LIST</b></h2>
        </header>
        <div class="w3-container">
          {% for follower in follower_list %}
          
          <div class="w3-hover-shadow name-card">
            <a href="/profile/{{follower.user}}" style="text-decoration:none;">
             <img class="w3-circle user-img" src="{{follower.profileimg.url}}" alt="Follower Avatar" style="width:30px; height: 30px;" /></a>
             <a href="/profile/{{follower.user}}" style="text-decoration:none;">
                <span class="modal-names capitalize"><b>{{follower.user}}</b></span>
                </a>
          </div>
          {% endfor %}
          <br><br>
        </div>
      </div>
    </div>

    <div id="following" class="w3-modal">
      <div class="w3-modal-content w3-card-4 w3-animate-zoom w3-round-xlarge modal-card">
        <header class="w3-container w3-center"> 
          <span onclick="document.getElementById('following').style.display='none'" 
          class="w3-button w3-display-topright" style="font-size: 25px;">&times;</span>
          <h2><b>FOLLOWING LIST</b></h2>
        </header>
        <div class="w3-container">
          {% for following in following_list %}
          
          <div class=" w3-hover-shadow name-card">
            <a href="/profile/{{following.user}}" style="text-decoration:none;"> 
            <img class="w3-circle user-img" src="{{following.profileimg.url}}" alt="Follower Avatar" style="width:30px; height: 30px;" /></a>
            <a href="/profile/{{following.user}}" style="text-decoration:none;"> 
                <span class="modal-names capitalize"><b>{{following.user}}</b></span>
              </a>
          </div>
          {% endfor %}
          <br><br>
        </div>
      </div>
    </div>

	{% if user_object.username == user.username %}
		<a href="/settings"><button type="button" class="w3-btn w3-border w3-round-large follow-button" style="background-color: transparent; color: white; position: absolute;"> <b>Account Settings</b> </button></a>
	{% else%}
        <form action="/follow" method="POST">
            {% csrf_token %}
            <input type="hidden" value="{{user.username}}" name="follower" />
	          <input type="hidden" value="{{user_object.username}}" name="user" />
            <button type="submit" class="w3-btn w3-border w3-round-large follow-button" style="background-color: transparent; color: white; position: absolute;">{{button_text}}</button>
        </form> 
    {% endif %}

    <div class="w3-container" style="margin-top: 50px;">
      {% for post in user_posts %}
      <div class="w3-card-4 post-card " style="background-color: #f2f2f2; position: relative;">
        <img src="{{ post.image.url }}" alt="User-Post" style="width:100%;">
        <div class="w3-container">
          <h3><b>{{ post.caption }}</b></h3>
          
        </div>
        {% if user_object.username == user.username %}
          <button type="button" onclick="delete_post('{{user_profile.user.username}}', '{{ post.id }}')" class="delete-button w3-btn"> <b><i class="fa fa-trash" style="font-size: 25px;"></i></b> </button>
				{% endif %}
      </div>
      {% endfor %}
    </div>
    <div class="username w3-text-white capitalize" style="position: absolute;">{{user_profile.user.username}}</div>
</div>-->


{% endblock %}
    
{% block myscript %}
<script>
  function delete_post(username, postId) {
      var confirmation = confirm("Are you sure you want to delete this post?");
      if (confirmation) {
          // If the user confirms, send a POST request to the delete view
          var formData = new FormData();
          formData.append('confirmation', 'yes');

          fetch('/delete/' + username + '/' + postId + '/', {
                  method: 'POST',
                  body: formData,
                  headers: {
                      'X-CSRFToken': '{{ csrf_token }}',
                  },
              })
              .then(response => response.json())
              .then(data => {
                  console.log(data.message);
                  if (data.message === 'Post deleted successfully') {
                      window.location.reload();
                  }
              })
              .catch(error => {
                  console.error('Error:', error);
              });
      }
  }

  // Get the modal
var modal1 = document.getElementById('follower');
var modal2 = document.getElementById('following');
// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal1) {
    modal1.style.display = "none";
  }
  if (event.target == modal2) {
    modal2.style.display = "none";
  }
}
</script>
{% endblock %}